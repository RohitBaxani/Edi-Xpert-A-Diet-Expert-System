{"version":3,"file":"point.js","sourceRoot":"","sources":["../../../src/components/label/point.ts"],"names":[],"mappings":";;;AAAA,mCAAqD;AAErD,0EAAgF;AAGhF;IAAiE,sCAAY;IAA7E;;IA+CA,CAAC;IA9CW,sCAAiB,GAA3B;QACU,IAAA,wBAAK,CAAgB;QACrB,IAAA,gBAAU,EAAV,+BAAU,CAAW;QAC7B,0BACE,OAAO,EAAE,CAAC,EACV,OAAO,EAAE,CAAC,IACP,KAAK,EACR;IACJ,CAAC;IAES,mCAAc,GAAxB;QACE,OAAO,IAAI,CAAC,4BAA4B,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IACpD,CAAC;IAES,sCAAiB,GAA3B,UAA4B,OAAgB,EAAE,GAAW;QAAzD,iBAeC;QAdO,IAAA,iBAAmC,EAAjC,gBAAK,EAAE,wBAA0B,CAAC;QAClC,IAAA,qBAAK,CAAa;QAC1B,IAAM,WAAW,GAAmB,UAAG,CAAC,OAAO,EAAE,mBAAmB,EAAE,EAAE,CAAC,CAAC;QAE1E,OAAO,UAAG,CAAC,WAAW,EAAE,UAAC,KAAK;YAC5B,IAAM,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACnC,8DACK,KAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAC1B,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,EACtD,SAAS,EAAE,QAAQ,EACnB,YAAY,EAAE,QAAQ,KACnB,KAAK,EACR;QACJ,CAAC,CAAC,CAAC;IACL,CAAC;IAES,6BAAQ,GAAlB,UAAmB,KAAmB;QACpC,OAAO,UAAG,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;IACvD,CAAC;IAES,gCAAW,GAArB,UAAsB,KAAmB;QACvC,IAAM,GAAG,GAAG;YACV,CAAC,EAAE,cAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YAC7C,CAAC,EAAE,cAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;SAC9C,CAAC;QACF,OAAO,GAAG,CAAC;IACb,CAAC;IAES,gCAAW,GAArB;QACE,OAAO;IACT,CAAC;IACH,iBAAC;AAAD,CAAC,AA/CD,CAAiE,cAAS,GA+CzE;;AAED,6BAAsB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC","sourcesContent":["import { get, map, isArray, last } from '@antv/util';\nimport { Element, MappingDatum } from '../../dependents';\nimport BaseLabel, { registerLabelComponent } from '../../components/label/base';\nimport { TextStyle, Label } from '../../interface/config';\n\nexport default class PointLabel<L extends Label = Label> extends BaseLabel<L> {\n  protected getDefaultOptions() {\n    const { theme } = this.layer;\n    const { label = {} } = theme;\n    return {\n      offsetX: 0,\n      offsetY: 0,\n      ...label,\n    };\n  }\n\n  protected getLabelOffset() {\n    return this.getLabelOffsetByDimAndFactor('y', -1);\n  }\n\n  protected getLabelItemAttrs(element: Element, idx: number): TextStyle[] {\n    const { style, formatter } = this.options;\n    const { shape } = element;\n    const mappingData: MappingDatum[] = get(element, 'model.mappingData', []);\n\n    return map(mappingData, (datum) => {\n      const value = this.getValue(datum);\n      return {\n        ...this.getPosition(datum),\n        text: formatter ? formatter(value, shape, idx) : value,\n        textAlign: 'center',\n        textBaseline: 'middle',\n        ...style,\n      };\n    });\n  }\n\n  protected getValue(datum: MappingDatum): number | undefined | null {\n    return get(datum._origin, this.layer.options.yField);\n  }\n\n  protected getPosition(datum: MappingDatum): { x: number; y: number } {\n    const pos = {\n      x: isArray(datum.x) ? last(datum.x) : datum.x,\n      y: isArray(datum.y) ? last(datum.y) : datum.y,\n    };\n    return pos;\n  }\n\n  protected adjustLabel() {\n    return;\n  }\n}\n\nregisterLabelComponent('point', PointLabel);\n"]}